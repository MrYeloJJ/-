<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>JavaScript函数1-20</title>
</head>
<body>
  <script type="text/javascript">
    // 封装年份函数
    function funAlertYear() {
      while(true) {
        var year = prompt("请输入您的出生年份");
        if(year.length != 4 || isNaN(year) != false) {
          alert("输入年份错误，请正确输入四位数数字");
          continue;
        } else {
          var intYear = parseInt(year);
          return intYear;
        }
      }
    }

    // 封装月份函数
    function funAlertMonth() {
      while(true) {
        var month = prompt("请输入您的出生月份");
        if(month < 1 || month > 12 || isNaN(month) != false || month.length > 2) {
          alert("输入月份错误，请正确输入两位数数字");
          continue;
        } else {
          var intMonth = parseInt(month);
          return intMonth;
        }
      }
    }

    // 封装日期函数
    function funAlertDay() {
      while(true) {
        var day = prompt("请输入您的出生日期");
        if(day < 1 || day > 31 || isNaN(day) != false || day.length > 2) {
          alert("输入日期错误，请正确输入两位数数字");
          continue;
        } else {
          var intDay = parseInt(day);
          return intDay;
        }
      }
    }

    // 计算闰年函数
    function funLeapYear(year, day) {
      var n = year % 4
      if(year % 4 == 0) {
        if(month >= 3 && day >= 1) {
          // 闰年且大于2月29日的则返回1
          return 1;
        } else {
          // 闰年且小于等于于2月29日的则返回0
          return 0;
        }
        //如果不是闰年，输入2月29日，则自动减1天
      } else if(month == 2 && day == 29) {
        // 普通年2月29日返回-1
        return -1;
      } else {
        // 普通年返回0
        return 0;
      }
    }

    // 接受日期并返回结果
    function funTotalDay(year, month, day) {
      var mon_list = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
      var sum = 0;
      for(var i = 0;i < month;i++) {
          sum+=mon_list[i];
          console.log(sum);
      }

      // 先计算全部月份的天数总和，再减去当月天数，再加上日期
      sum-=mon_list[month - 1];
      sum+=day;

      // 0:天数不变，1:天数+1，-1:天数-1
      var leapYaer = funLeapYear(year, day)
      if(leapYaer == 1) {
        console.log("总天数：" + (sum + 1));
        return sum + 1;
      } else if(leapYaer == 0) {
        console.log("总天数：" + sum);
        return sum;
      } else if(leapYaer == -1) {
        console.log("总天数：" + (sum - 1));
        return sum - 1;
      }
    }

    var year = funAlertYear();
    var month = funAlertMonth();
    var day = funAlertDay();
    var nYear = year, nMonth = month, nDay = day;
    var totalDay = funTotalDay(nYear, nMonth, nDay);
    document.write("您的生日在" + nYear + "年是第" + totalDay + "天");

    // 这里为什么不可以将变量当做参数传入呢?
    // funTotalDay(year, month, day);
  </script>
</body>
</html>
